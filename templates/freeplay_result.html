<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üåç Free Play Result</title>
<style>
  body { font-family: Arial, sans-serif; background: #f4f6f8; margin: 0; padding: 20px; text-align: center; }
  .container { max-width: 900px; margin: 20px auto; padding: 20px; background: #fff; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
  .scorebar { font-size: 24px; margin: 15px 0; }
  #map { width: 100%; height: 400px; border-radius: 10px; margin-top: 10px; }
  .btn { padding: 12px 25px; font-size: 16px; border-radius: 6px; border: none; cursor: pointer; margin-top: 15px; background: #28a745; color: white; text-decoration: none; display: inline-block; }
  .expedia-banner { margin: 20px 0; }
</style>
</head>
<body>

<div class="container">
  <h1>Free Play Result</h1>

  <div class="scorebar">
    üìç Distance: {{ distance_km }} km ({{ distance_mi }} mi) <br>
    {{ bar }}
  </div>

  <!-- Expedia Ad -->
  <div class="expedia-banner">
    <div class="eg-affiliate-banners"
         data-program="us-expedia"
         data-network="pz"
         data-layout="leaderboard"
         data-image="adventure"
         data-message="explore-world-travel"
         data-camref="1100l5uUXS"
         data-pubref=""
         data-link="home"></div>
    <script class="eg-affiliate-banners-script" src="https://creator.expediagroup.com/products/banners/assets/eg-affiliate-banners.js"></script>
  </div>

  <!-- Map -->
  <div id="map"></div>

  <a href="{{ url_for('freeplay') }}" class="btn">‚û°Ô∏è Next Free Play</a>
</div>

<script src="https://maps.googleapis.com/maps/api/js?key={{ api_key }}"></script>
<script>
  const guessedLat = {{ guessed_lat }};
  const guessedLng = {{ guessed_lon }};
  const actualLat = {{ actual_lat }};
  const actualLng = {{ actual_lon }};

  const map = new google.maps.Map(document.getElementById("map"), {
    zoom: 4,
    center: { lat: (guessedLat + actualLat)/2, lng: (guessedLng + actualLng)/2 }
  });

  const guessMarker = new google.maps.Marker({
    position: { lat: guessedLat, lng: guessedLng },
    map,
    title: "Your Guess",
    icon: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png"
  });

  const actualMarker = new google.maps.Marker({
    position: { lat: actualLat, lng: actualLng },
    map,
    title: "Actual Location",
    icon: "http://maps.google.com/mapfiles/ms/icons/red-dot.png"
  });

  const line = new google.maps.Polyline({
    path: [{lat: guessedLat, lng: guessedLng}, {lat: actualLat, lng: actualLng}],
    geodesic: true,
    strokeColor: "#e74c3c",
    strokeOpacity: 1.0,
    strokeWeight: 3,
    map
  });

  const bounds = new google.maps.LatLngBounds();
  bounds.extend({lat: guessedLat, lng: guessedLng});
  bounds.extend({lat: actualLat, lng: actualLng});
  map.fitBounds(bounds);
</script>

</body>
</html>
